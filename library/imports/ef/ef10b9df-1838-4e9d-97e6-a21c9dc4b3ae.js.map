{"version":3,"sources":["assets\\Scripts\\Game_script.js"],"names":["cc","Class","Component","properties","starPrefab","type","Prefab","maxStarDuration","minStarDuration","ground","Node","player","scoreDisplay","Label","scoreAudio","AudioClip","onLoad","groundY","y","height","timer","starDuration","spawnNewStar","score","newStar","instantiate","node","addChild","setPosition","getNewStarPosition","getComponent","game","Math","random","randX","randY","jumpHeight","maxX","width","v2","update","dt","gameOver","gainScore","string","audioEngine","playEffect","stopAllActions","log"],"mappings":"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","sourceRoot":"/","sourcesContent":["\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: \r\n    {\r\n        //这个属性引用了星星预制体资源\r\n        starPrefab :\r\n        {\r\n            //无默认值\r\n            default: null,\r\n            //类型 预制体\r\n            type: cc.Prefab\r\n        },\r\n\r\n        //时间范围\r\n        maxStarDuration: 0,\r\n        minStarDuration: 0,\r\n        \r\n        //获取地面节点\r\n        ground: \r\n        {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n\r\n        //获取主角\r\n        player: \r\n        {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n\r\n        //文本对象\r\n        scoreDisplay:\r\n        {\r\n            default: null,\r\n            type: cc.Label\r\n        },\r\n\r\n        //声明音源属性\r\n        scoreAudio:\r\n        {\r\n            default: null,\r\n            type: cc.AudioClip\r\n        },\r\n    },\r\n\r\n     onLoad () \r\n     {\r\n        //获取地面Y轴值\r\n        this.groundY = this.ground.y + this.ground.height / 2;\r\n\r\n        //计时器\r\n        this.timer = 0;\r\n        this.starDuration = 0;\r\n\r\n        //调用方法 生成新星\r\n        this.spawnNewStar();\r\n        //初始化分数\r\n        this.score = 0;\r\n\r\n     },\r\n\r\n     //生成新星方法\r\n    spawnNewStar()\r\n    {\r\n        //类型 对象n = 类.生成(传入的物体)\r\n        var newStar = cc.instantiate(this.starPrefab);\r\n        //将对象n添加到 Canvas 节点下\r\n        this.node.addChild(newStar);\r\n        //设置对象n基于父物体的位置(XY或vec2)\r\n        newStar.setPosition(this.getNewStarPosition());\r\n\r\n        //在星星组件上暂存 game 引用\r\n        newStar.getComponent('Star').game = this;\r\n\r\n         // 重置计时器，根据消失时间范围随机取一个值\r\n        this.starDuration = this.minStarDuration + Math.random() * (this.maxStarDuration - this.minStarDuration);\r\n        this.timer = 0;\r\n    },\r\n\r\n    getNewStarPosition ()\r\n    {\r\n    //横轴归零\r\n    var randX = 0;\r\n    //纵轴 = 地面的Y轴 + 数学.随机() * 玩家人物.'Player'脚本.跳跃高度值 + 50 \r\n    var randY = this.groundY + Math.random() * this.player.getComponent('Player_script').jumpHeight + 50;\r\n\r\n    //根据屏幕宽度 随机得到一个X坐标\r\n    var maxX = this.node.width / 2;\r\n    randX = (Math.random() - 0.5) * 2 * maxX;\r\n\r\n    //返回XY轴值\r\n    return cc.v2(randX,randY);\r\n    },\r\n\r\n     update (dt) \r\n     {\r\n         if(this.timer > this.starDuration)\r\n         {\r\n             this.gameOver();\r\n             //有执行到\r\n             //cc.log(\"Game Over\");\r\n             return;\r\n         }\r\n         this.timer += dt;\r\n     },\r\n\r\n\r\n    //更新得分显示方法\r\n    gainScore()\r\n    {\r\n        //分数+=1\r\n        this.score += 1;\r\n        //刷新文本信息\r\n        this.scoreDisplay.string = 'Score: ' + this.score;\r\n        //播放音效\r\n        cc.audioEngine.playEffect(this.scoreAudio,false);\r\n    },\r\n\r\n    //游戏结束方法\r\n    gameOver()\r\n    {\r\n        //停止玩家对象的动作\r\n        this.node.player.stopAllActions();\r\n\r\n        //cc.director.loadScene('game');\r\n\r\n        /*\r\n        this.player.stopAllActions(); //停止 player 节点的跳跃动作\r\n        cc.director.loadScene('game');\r\n        */\r\n        \r\n        cc.log(\"game over\");\r\n    }\r\n    \r\n\r\n});\r\n"]}